<div class="container-fluid d-flex flex-column align-items-stretch align-self-stretch p-0 ">
    <!--header-->
    <div class="container-fluid w-10 border-bottom border-1 border-line" style="padding: 0;">
        <!-- Copertina -->
        <div class="profile-container">
              <!-- Immagine backdrop -->
            <img (click)="openBackdropModal()"
                 [src]="backdropImage ? backdropImage : 'https://img.freepik.com/premium-photo/empty-brown-white-studio-backdropabstract-gradient-grey-background_861973-224.jpg'"
                 alt="Copertina" class="cover-image">
              <!-- Immagine profilo -->
            <img (click)="openProfiledModal()"
                 [src]="profileImage ? profileImage : 'https://img.freepik.com/premium-photo/empty-brown-white-studio-backdropabstract-gradient-grey-background_861973-224.jpg'"
                 alt="Profilo" class="profile-image bg-dark">
        </div>

        <div class="container-fluid d-flex flex-row-reverse flex-basis mb-4 text-light ml"> <!-- meta' inferiore header-->
            <table id="table1" class="table mt-5">
                <thead>
                <tr>
                    <th scope="col" class="text-right text-light">Preferred Game</th>
                    <th scope="col" class="text-right text-light">Recently played</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="text-right ">
                        <img
                            [src]="imgVideogamePreferred"
                            class="firstpic img-fluid w-75 img-thumbnail me-4"
                            alt="Preferred Game Image"
                            style="width: 13%; aspect-ratio: 6/6; height: auto;">
                    </td>
                    <td class="text-right">
                        <img
                            [src]="userProfile.lastPlayedGameImgUrl"
                            class="secondpic img-fluid w-75 img-thumbnail me-4"
                            alt="Last Played Game Image"
                            style="width: 13%; aspect-ratio: 6/6; height: auto;">
                    </td>
                </tr>
                </tbody>
            </table>
            <table id="custom-margin-left" class="table ms-5 ps-5 ">
                <thead>
                <tr>
                    <th scope="col"></th>
                    <th scope="col"></th>
                    <th scope="col"></th>
                    <th scope="col" class="align-middle"></th> <!-- Fourth column header -->
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="h3"></td>
                    <td class="h3"></td>
                    <td class="h3"></td>
                    <td class="h1 text-center align-middle text-right text-line bold"> <!-- Fourth column aligned right -->
                        {{ userProfile.profileName }}
                    </td>
                </tr>
                <tr>
                    <td class="h3"></td>
                    <td class="h3"></td>
                    <td class="h5"></td>
                    <td class="h6 text-right text-light"> <!-- Fourth column aligned right -->
                        Steam: {{ userProfile.steamName }}
                    </td>
                </tr>
                <tr>
                    <td class="h3"></td>
                    <td class="h3"></td>
                    <td class="h5"></td>
                    <td class="h6 text-right text-light"> <!-- Fourth column aligned right -->
                        Xbox: {{ userProfile.xboxName }}
                    </td>
                </tr>
                <tr>
                    <td class="h3"></td>
                    <td class="h3"></td>
                    <td class="h5"></td>
                    <td class="h6 text-right text-light"> <!-- Fourth column aligned right -->
                        Playstation: {{ userProfile.playstationName }}
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="row my-5 d-flex flex-column align-self-stretch align-items-stretch bg-dark text-light text-center ">
        <div class="col border-1 border-line ">
            <div class="container d-flex flex-column bg-transparent border-line text-light" >
                <div class="container text-light card bg-transparent border-2 border-line d-flex flex-column">
                    <div class="card-body">
                        <p>New Post</p>
                        <input
                            class="input-group bg-transparent text-light border-1 border-line"
                            type="text"
                            placeholder="Write Something..."
                            [(ngModel)]="newPost.content">
                    </div>
                    <div class="card-footer ">
                        <button class="btn btn-line" (click)="makeAPost()">Post</button>
                    </div>
                </div>
                <div *ngFor="let p of allPosts$ | async">
                    <app-user-post
                    (delete)="deletePost($event)"
                    [post] = "p"
                    [user] = "userProfile"
                    [profileImg]="profileImage"
                    ></app-user-post>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Backdrop Modal -->
<div *ngIf="isBackdropModalOpen" class="modal-overlay">
  <div class="modal-content">
    <h2>Change Backdrop Profile Image</h2>
    <input type="file" (change)="backdropFileChangeEvent($event)" />

    <image-cropper
      [imageChangedEvent]="backdropImageChangedEvent"
      [maintainAspectRatio]="true"
      [aspectRatio]="4 / 3"
      [resizeToWidth]="500"

    format="png"
      (imageCropped)="backdropImageCropped($event)"
      (imageLoaded)="backdropImageLoaded($event)"
      (cropperReady)="backdropCropperReady()"
      (loadImageFailed)="backdropLoadImageFailed()"
    ></image-cropper>

    <img [src]="backdropCroppedImage" class="preview-image" />
    <button class="btn btn-line" (click)="saveBackdropCroppedImage()">Save</button>
    <button class="btn btn-danger" (click)="closeBackdropModal()">Cancel</button>
  </div>
</div>

<!-- Profile IMG Modal -->
<div *ngIf="isProfileModalOpen" class="modal-overlay">
  <div class="modal-content">
    <h2>Change Profile Image</h2>
    <input type="file" (change)="profileFileChangeEvent($event)"/>

    <image-cropper
      [imageChangedEvent]="profileImageChangedEvent"
      [maintainAspectRatio]="true"
      [aspectRatio]="4 / 3"
      [resizeToWidth]="500"

      format="png"
      (imageCropped)="profileImageCropped($event)"
      (imageLoaded)="profileImageLoaded($event)"
      (cropperReady)="profileCropperReady()"
      (loadImageFailed)="profileLoadImageFailed()"
    ></image-cropper>

    <img [src]="profileCroppedImage" class="preview-image"/>
    <button class="btn btn-line" (click)="saveProfileCroppedImage()">Save</button>
    <button class="btn btn-danger" (click)="closeProfileModal()">Cancel</button>
  </div>
</div>
